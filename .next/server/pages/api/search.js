"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/search";
exports.ids = ["pages/api/search"];
exports.modules = {

/***/ "ioredis":
/*!**************************!*\
  !*** external "ioredis" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("ioredis");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = import("axios");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsearch&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fsearch.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsearch&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fsearch.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_search_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/search.js */ \"(api)/./pages/api/search.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_search_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_search_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_search_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_search_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/search\",\n        pathname: \"/api/search\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_search_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnNlYXJjaCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGc2VhcmNoLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ2tEO0FBQ2xEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxpREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsaURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktZ3JhcGhxbC1wcm9qZWN0Lz85YzRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvc2VhcmNoLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc2VhcmNoXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc2VhcmNoXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsearch&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fsearch.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/search.js":
/*!*****************************!*\
  !*** ./pages/api/search.js ***!
  \*****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ioredis */ \"ioredis\");\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(ioredis__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pg__WEBPACK_IMPORTED_MODULE_2__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_0__]);\naxios__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Initialize Redis client with fallback\nlet redisClient;\ntry {\n    redisClient = new (ioredis__WEBPACK_IMPORTED_MODULE_1___default())(process.env.REDIS_URL, {\n        maxRetriesPerRequest: 1,\n        retryStrategy: ()=>null\n    });\n    redisClient.on(\"error\", (err)=>{\n        console.warn(\"Redis Client Error:\", err);\n        redisClient = null; // Disable Redis client on error\n    });\n} catch (error) {\n    console.warn(\"Failed to initialize Redis:\", error);\n    redisClient = null;\n}\n// Initialize PostgreSQL connection pool\nlet pool;\ntry {\n    pool = new pg__WEBPACK_IMPORTED_MODULE_2__.Pool({\n        connectionString: process.env.DATABASE_URL,\n        ssl:  false ? 0 : false\n    });\n    // Test the connection\n    pool.query(\"SELECT NOW()\", (err, res)=>{\n        if (err) {\n            console.error(\"Error connecting to the database:\", err);\n        } else {\n            console.log(\"Successfully connected to the database\");\n        }\n    });\n} catch (error) {\n    console.error(\"Failed to initialize database pool:\", error);\n}\n// Cache helper function\nconst cacheHelper = {\n    get: async (key)=>{\n        if (redisClient) {\n            try {\n                return await redisClient.get(key);\n            } catch (error) {\n                console.warn(\"Redis get error:\", error);\n            }\n        }\n        return null;\n    },\n    set: async (key, value, options)=>{\n        if (redisClient) {\n            try {\n                await redisClient.set(key, value, options);\n            } catch (error) {\n                console.warn(\"Redis set error:\", error);\n            }\n        }\n    }\n};\nconst mapProduct = (item, source)=>{\n    console.log(`Mapping product from ${source}:`, JSON.stringify(item, null, 2));\n    if (source === \"walmart\") {\n        return {\n            id: item.id || \"\",\n            brand: item.brand || \"N/A\",\n            title: item.name || \"\",\n            link: item.url || \"\",\n            image: item.image || \"\",\n            isPrime: false,\n            rating: item.rating?.average_rating ? Number(item.rating.average_rating).toFixed(1) : \"0.0\",\n            ratingsTotal: item.rating?.number_of_reviews || 0,\n            price: item.price ? `${item.price_currency || \"$\"}${Number(item.price).toFixed(2)}` : \"N/A\",\n            availability: item.availability || \"Unavailable\",\n            source: \"walmart\",\n            sponsored: item.sponsored || false,\n            full_description: item.full_description || \"\",\n            product_category: item.product_category || \"\",\n            model: item.model || \"\",\n            small_description: item.small_description || \"\"\n        };\n    } else if (source === \"amazon\") {\n        return {\n            asin: item.asin || \"\",\n            brand: item.brand || \"N/A\",\n            title: item.name || item.title || \"\",\n            link: item.url || item.link || \"\",\n            image: item.image || item.images && item.images[0] || \"\",\n            isPrime: item.has_prime || item.isPrime || false,\n            rating: item.stars || item.average_rating ? Number(item.stars || item.average_rating).toFixed(1) : \"0.0\",\n            ratingsTotal: item.total_reviews || item.ratings_total || 0,\n            price: item.price || item.pricing || \"N/A\",\n            availability: item.availability || \"Unavailable\",\n            source: \"amazon\",\n            sponsored: item.sponsored || false,\n            full_description: item.full_description || \"\",\n            product_category: item.product_category || \"\",\n            model: item.model || \"\",\n            small_description: item.small_description || \"\"\n        };\n    }\n};\nconst filterSponsoredProducts = (products)=>{\n    return products.filter((product)=>!product.sponsored);\n};\nconst insertProduct = async (product)=>{\n    if (!pool) {\n        console.error(\"Database pool not initialized\");\n        return;\n    }\n    const client = await pool.connect();\n    try {\n        await client.query(\"BEGIN\");\n        // Insert into products table\n        const productQuery = `\n      INSERT INTO products (retailer_id, source, title, brand, image_url, link, full_description, product_category)\n      VALUES ($1, $2, $3, $4, $5, $6, $7, $8)\n      ON CONFLICT (retailer_id, source) DO UPDATE\n      SET title = EXCLUDED.title, brand = EXCLUDED.brand, image_url = EXCLUDED.image_url, \n          link = EXCLUDED.link, full_description = EXCLUDED.full_description, \n          product_category = EXCLUDED.product_category\n      RETURNING product_id\n    `;\n        const productValues = [\n            product.id || product.asin,\n            product.source,\n            product.title,\n            product.brand,\n            product.image,\n            product.link,\n            product.full_description,\n            product.product_category\n        ];\n        const productResult = await client.query(productQuery, productValues);\n        const productId = productResult.rows[0].product_id;\n        // Insert into product_details table\n        const detailsQuery = `\n      INSERT INTO product_details (product_id, rating, ratings_total, is_prime, model, small_description)\n      VALUES ($1, $2, $3, $4, $5, $6)\n      ON CONFLICT (product_id) DO UPDATE\n      SET rating = EXCLUDED.rating, ratings_total = EXCLUDED.ratings_total, \n          is_prime = EXCLUDED.is_prime, model = EXCLUDED.model, \n          small_description = EXCLUDED.small_description\n    `;\n        const detailsValues = [\n            productId,\n            parseFloat(product.rating) || null,\n            parseInt(product.ratingsTotal) || null,\n            product.isPrime || false,\n            product.model,\n            product.small_description\n        ];\n        await client.query(detailsQuery, detailsValues);\n        // Insert into price_history table\n        if (product.price && product.price !== \"N/A\") {\n            const priceQuery = `\n        INSERT INTO price_history (product_id, price, availability)\n        VALUES ($1, $2, $3)\n      `;\n            const priceValues = [\n                productId,\n                parseFloat(product.price.replace(/[^0-9.-]+/g, \"\")) || null,\n                product.availability || \"Unknown\"\n            ];\n            await client.query(priceQuery, priceValues);\n        }\n        await client.query(\"COMMIT\");\n        console.log(`Inserted/Updated product in database: ${product.title}`);\n    } catch (e) {\n        await client.query(\"ROLLBACK\");\n        console.error(\"Error inserting/updating product in database:\", e);\n    } finally{\n        client.release();\n    }\n};\nconst fetchProducts = async (term, source, sortBy, page = 1)=>{\n    let url;\n    let params;\n    // Remove any quotes from the API key\n    const apiKey = process.env.SCRAPER_API_KEY.replace(/[''\"]+/g, \"\");\n    if (source === \"amazon\") {\n        if (term.match(/^[A-Z0-9]{10}$/)) {\n            url = `https://api.scraperapi.com/structured/amazon/product`;\n            params = {\n                api_key: apiKey,\n                asin: term,\n                country_code: \"us\",\n                tld: \"com\"\n            };\n        } else {\n            url = `https://api.scraperapi.com/structured/amazon/search`;\n            params = {\n                api_key: apiKey,\n                query: term,\n                country: \"us\",\n                page: page.toString(),\n                sort_by: sortBy || \"\",\n                exclude_sponsored: \"true\"\n            };\n        }\n    } else if (source === \"walmart\") {\n        if (term.match(/^[0-9]+$/)) {\n            url = `https://api.scraperapi.com/structured/walmart/product`;\n            params = {\n                api_key: apiKey,\n                product_id: term,\n                country_code: \"us\",\n                tld: \"com\"\n            };\n        } else {\n            url = `https://api.scraperapi.com/structured/walmart/search`;\n            params = {\n                api_key: apiKey,\n                query: term,\n                country: \"us\",\n                page: page.toString(),\n                sort_by: sortBy || \"\",\n                exclude_sponsored: \"true\"\n            };\n        }\n    }\n    try {\n        console.log(`Fetching ${source} results for term: \"${term}\", page: ${page}, sortBy: ${sortBy}`);\n        console.log(\"API Request URL:\", url);\n        console.log(\"API Request Params:\", {\n            ...params,\n            api_key: \"[REDACTED]\"\n        });\n        const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(url, {\n            params,\n            timeout: 30000\n        });\n        console.log(`Raw API response from ${source}:`, JSON.stringify(response.data, null, 2));\n        let jsonData = response.data;\n        if (source === \"amazon\" && term.match(/^[A-Z0-9]{10}$/) || source === \"walmart\" && term.match(/^[0-9]+$/)) {\n            // If it's a product query, wrap the result in an array\n            const mappedProduct = mapProduct(jsonData, source);\n            await insertProduct(mappedProduct);\n            return {\n                results: [\n                    mappedProduct\n                ],\n                totalPages: 1\n            };\n        } else {\n            // For search queries, process as before\n            let results = [];\n            let totalPages = 1;\n            if (source === \"walmart\" && jsonData.items && Array.isArray(jsonData.items)) {\n                results = jsonData.items;\n                totalPages = jsonData.total_pages || 1;\n            } else if (source === \"amazon\" && jsonData.results) {\n                results = jsonData.results;\n                totalPages = jsonData.total_pages || 1;\n            } else {\n                console.error(`Invalid API response structure from ${source}:`, jsonData);\n                throw new Error(`Invalid API response structure from ${source}`);\n            }\n            const mappedResults = results.map((item)=>mapProduct(item, source));\n            console.log(`Mapped results for ${source}:`, JSON.stringify(mappedResults, null, 2));\n            // Insert all products into the database\n            for (const product of mappedResults){\n                await insertProduct(product);\n            }\n            return {\n                results: filterSponsoredProducts(mappedResults),\n                totalPages\n            };\n        }\n    } catch (error) {\n        console.error(`Error fetching data from ${source} API:`, error.message);\n        console.error(`Error details:`, error.response ? error.response.data : \"No response data\");\n        throw error;\n    }\n};\nasync function handler(req, res) {\n    if (req.method !== \"GET\") {\n        return res.status(405).end();\n    }\n    const { term, page = \"1\", sort_by, source = \"all\" } = req.query;\n    res.setHeader(\"Content-Type\", \"application/json\");\n    const results = [];\n    const streamResults = async (sourceToFetch)=>{\n        const cacheKey = `search:${sourceToFetch}:${term}:${sort_by}:${page}`;\n        try {\n            const cachedResults = await cacheHelper.get(cacheKey);\n            if (cachedResults) {\n                console.log(`Using cached results for ${sourceToFetch}`);\n                results.push({\n                    source: sourceToFetch,\n                    ...JSON.parse(cachedResults)\n                });\n            } else {\n                console.log(`Fetching fresh results for ${sourceToFetch}`);\n                const { results: sourceResults, totalPages } = await fetchProducts(term, sourceToFetch, sort_by, parseInt(page));\n                results.push({\n                    source: sourceToFetch,\n                    results: sourceResults,\n                    totalPages\n                });\n                await cacheHelper.set(cacheKey, JSON.stringify({\n                    results: sourceResults,\n                    totalPages\n                }), {\n                    EX: 3600\n                }); // Cache for 1 hour\n            }\n        } catch (error) {\n            console.error(`Error streaming results from ${sourceToFetch}:`, error.message);\n            results.push({\n                source: sourceToFetch,\n                error: `Failed to fetch data from ${sourceToFetch}: ${error.message}`,\n                details: error.response ? error.response.data : \"No response data\"\n            });\n        }\n    };\n    if (source === \"all\") {\n        await Promise.all([\n            streamResults(\"walmart\"),\n            streamResults(\"amazon\")\n        ]);\n    } else {\n        await streamResults(source);\n    }\n    res.status(200).json(results);\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMsQ0FBQyw2QkFBNkIsRUFBRTRHLGNBQWMsQ0FBQyxDQUFDLEVBQUU1RyxNQUFNb0csT0FBTztZQUM3RVQsUUFBUW9CLElBQUksQ0FBQztnQkFDWDlGLFFBQVEyRjtnQkFDUjVHLE9BQU8sQ0FBQywwQkFBMEIsRUFBRTRHLGNBQWMsRUFBRSxFQUFFNUcsTUFBTW9HLE9BQU8sQ0FBQyxDQUFDO2dCQUNyRWUsU0FBU25ILE1BQU1zRixRQUFRLEdBQUd0RixNQUFNc0YsUUFBUSxDQUFDRSxJQUFJLEdBQUc7WUFDbEQ7UUFDRjtJQUNGO0lBRUEsSUFBSXZFLFdBQVcsT0FBTztRQUNwQixNQUFNbUcsUUFBUUMsR0FBRyxDQUFDO1lBQ2hCVixjQUFjO1lBQ2RBLGNBQWM7U0FDZjtJQUNILE9BQU87UUFDTCxNQUFNQSxjQUFjMUY7SUFDdEI7SUFFQVYsSUFBSWlHLE1BQU0sQ0FBQyxLQUFLYyxJQUFJLENBQUMzQjtBQUN2QiIsInNvdXJjZXMiOlsid2VicGFjazovL215LWdyYXBocWwtcHJvamVjdC8uL3BhZ2VzL2FwaS9zZWFyY2guanM/NWQzYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xuaW1wb3J0IFJlZGlzIGZyb20gJ2lvcmVkaXMnO1xuaW1wb3J0IHsgUG9vbCB9IGZyb20gJ3BnJztcblxuLy8gSW5pdGlhbGl6ZSBSZWRpcyBjbGllbnQgd2l0aCBmYWxsYmFja1xubGV0IHJlZGlzQ2xpZW50O1xudHJ5IHtcbiAgcmVkaXNDbGllbnQgPSBuZXcgUmVkaXMocHJvY2Vzcy5lbnYuUkVESVNfVVJMLCB7XG4gICAgbWF4UmV0cmllc1BlclJlcXVlc3Q6IDEsXG4gICAgcmV0cnlTdHJhdGVneTogKCkgPT4gbnVsbFxuICB9KTtcbiAgcmVkaXNDbGllbnQub24oJ2Vycm9yJywgKGVycikgPT4ge1xuICAgIGNvbnNvbGUud2FybignUmVkaXMgQ2xpZW50IEVycm9yOicsIGVycik7XG4gICAgcmVkaXNDbGllbnQgPSBudWxsOyAvLyBEaXNhYmxlIFJlZGlzIGNsaWVudCBvbiBlcnJvclxuICB9KTtcbn0gY2F0Y2ggKGVycm9yKSB7XG4gIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGluaXRpYWxpemUgUmVkaXM6JywgZXJyb3IpO1xuICByZWRpc0NsaWVudCA9IG51bGw7XG59XG5cbi8vIEluaXRpYWxpemUgUG9zdGdyZVNRTCBjb25uZWN0aW9uIHBvb2xcbmxldCBwb29sO1xudHJ5IHtcbiAgcG9vbCA9IG5ldyBQb29sKHtcbiAgICBjb25uZWN0aW9uU3RyaW5nOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwsXG4gICAgc3NsOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nID8geyByZWplY3RVbmF1dGhvcml6ZWQ6IGZhbHNlIH0gOiBmYWxzZVxuICB9KTtcblxuICAvLyBUZXN0IHRoZSBjb25uZWN0aW9uXG4gIHBvb2wucXVlcnkoJ1NFTEVDVCBOT1coKScsIChlcnIsIHJlcykgPT4ge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNvbm5lY3RpbmcgdG8gdGhlIGRhdGFiYXNlOicsIGVycik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsbHkgY29ubmVjdGVkIHRvIHRoZSBkYXRhYmFzZScpO1xuICAgIH1cbiAgfSk7XG59IGNhdGNoIChlcnJvcikge1xuICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gaW5pdGlhbGl6ZSBkYXRhYmFzZSBwb29sOicsIGVycm9yKTtcbn1cblxuLy8gQ2FjaGUgaGVscGVyIGZ1bmN0aW9uXG5jb25zdCBjYWNoZUhlbHBlciA9IHtcbiAgZ2V0OiBhc3luYyAoa2V5KSA9PiB7XG4gICAgaWYgKHJlZGlzQ2xpZW50KSB7XG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gYXdhaXQgcmVkaXNDbGllbnQuZ2V0KGtleSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ1JlZGlzIGdldCBlcnJvcjonLCBlcnJvcik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9LFxuICBzZXQ6IGFzeW5jIChrZXksIHZhbHVlLCBvcHRpb25zKSA9PiB7XG4gICAgaWYgKHJlZGlzQ2xpZW50KSB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCByZWRpc0NsaWVudC5zZXQoa2V5LCB2YWx1ZSwgb3B0aW9ucyk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ1JlZGlzIHNldCBlcnJvcjonLCBlcnJvcik7XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuXG5jb25zdCBtYXBQcm9kdWN0ID0gKGl0ZW0sIHNvdXJjZSkgPT4ge1xuICBjb25zb2xlLmxvZyhgTWFwcGluZyBwcm9kdWN0IGZyb20gJHtzb3VyY2V9OmAsIEpTT04uc3RyaW5naWZ5KGl0ZW0sIG51bGwsIDIpKTtcblxuICBpZiAoc291cmNlID09PSAnd2FsbWFydCcpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IGl0ZW0uaWQgfHwgJycsXG4gICAgICBicmFuZDogaXRlbS5icmFuZCB8fCAnTi9BJyxcbiAgICAgIHRpdGxlOiBpdGVtLm5hbWUgfHwgJycsXG4gICAgICBsaW5rOiBpdGVtLnVybCB8fCAnJyxcbiAgICAgIGltYWdlOiBpdGVtLmltYWdlIHx8ICcnLFxuICAgICAgaXNQcmltZTogZmFsc2UsXG4gICAgICByYXRpbmc6IGl0ZW0ucmF0aW5nPy5hdmVyYWdlX3JhdGluZyA/IE51bWJlcihpdGVtLnJhdGluZy5hdmVyYWdlX3JhdGluZykudG9GaXhlZCgxKSA6ICcwLjAnLFxuICAgICAgcmF0aW5nc1RvdGFsOiBpdGVtLnJhdGluZz8ubnVtYmVyX29mX3Jldmlld3MgfHwgMCxcbiAgICAgIHByaWNlOiBpdGVtLnByaWNlID8gYCR7aXRlbS5wcmljZV9jdXJyZW5jeSB8fCAnJCd9JHtOdW1iZXIoaXRlbS5wcmljZSkudG9GaXhlZCgyKX1gIDogXCJOL0FcIixcbiAgICAgIGF2YWlsYWJpbGl0eTogaXRlbS5hdmFpbGFiaWxpdHkgfHwgXCJVbmF2YWlsYWJsZVwiLFxuICAgICAgc291cmNlOiAnd2FsbWFydCcsXG4gICAgICBzcG9uc29yZWQ6IGl0ZW0uc3BvbnNvcmVkIHx8IGZhbHNlLFxuICAgICAgZnVsbF9kZXNjcmlwdGlvbjogaXRlbS5mdWxsX2Rlc2NyaXB0aW9uIHx8ICcnLFxuICAgICAgcHJvZHVjdF9jYXRlZ29yeTogaXRlbS5wcm9kdWN0X2NhdGVnb3J5IHx8ICcnLFxuICAgICAgbW9kZWw6IGl0ZW0ubW9kZWwgfHwgJycsXG4gICAgICBzbWFsbF9kZXNjcmlwdGlvbjogaXRlbS5zbWFsbF9kZXNjcmlwdGlvbiB8fCAnJ1xuICAgIH07XG4gIH0gZWxzZSBpZiAoc291cmNlID09PSAnYW1hem9uJykge1xuICAgIHJldHVybiB7XG4gICAgICBhc2luOiBpdGVtLmFzaW4gfHwgJycsXG4gICAgICBicmFuZDogaXRlbS5icmFuZCB8fCAnTi9BJyxcbiAgICAgIHRpdGxlOiBpdGVtLm5hbWUgfHwgaXRlbS50aXRsZSB8fCAnJyxcbiAgICAgIGxpbms6IGl0ZW0udXJsIHx8IGl0ZW0ubGluayB8fCAnJyxcbiAgICAgIGltYWdlOiBpdGVtLmltYWdlIHx8IChpdGVtLmltYWdlcyAmJiBpdGVtLmltYWdlc1swXSkgfHwgJycsXG4gICAgICBpc1ByaW1lOiBpdGVtLmhhc19wcmltZSB8fCBpdGVtLmlzUHJpbWUgfHwgZmFsc2UsXG4gICAgICByYXRpbmc6IGl0ZW0uc3RhcnMgfHwgaXRlbS5hdmVyYWdlX3JhdGluZyA/IE51bWJlcihpdGVtLnN0YXJzIHx8IGl0ZW0uYXZlcmFnZV9yYXRpbmcpLnRvRml4ZWQoMSkgOiAnMC4wJyxcbiAgICAgIHJhdGluZ3NUb3RhbDogaXRlbS50b3RhbF9yZXZpZXdzIHx8IGl0ZW0ucmF0aW5nc190b3RhbCB8fCAwLFxuICAgICAgcHJpY2U6IGl0ZW0ucHJpY2UgfHwgaXRlbS5wcmljaW5nIHx8IFwiTi9BXCIsXG4gICAgICBhdmFpbGFiaWxpdHk6IGl0ZW0uYXZhaWxhYmlsaXR5IHx8IFwiVW5hdmFpbGFibGVcIixcbiAgICAgIHNvdXJjZTogJ2FtYXpvbicsXG4gICAgICBzcG9uc29yZWQ6IGl0ZW0uc3BvbnNvcmVkIHx8IGZhbHNlLFxuICAgICAgZnVsbF9kZXNjcmlwdGlvbjogaXRlbS5mdWxsX2Rlc2NyaXB0aW9uIHx8ICcnLFxuICAgICAgcHJvZHVjdF9jYXRlZ29yeTogaXRlbS5wcm9kdWN0X2NhdGVnb3J5IHx8ICcnLFxuICAgICAgbW9kZWw6IGl0ZW0ubW9kZWwgfHwgJycsXG4gICAgICBzbWFsbF9kZXNjcmlwdGlvbjogaXRlbS5zbWFsbF9kZXNjcmlwdGlvbiB8fCAnJ1xuICAgIH07XG4gIH1cbn07XG5cbmNvbnN0IGZpbHRlclNwb25zb3JlZFByb2R1Y3RzID0gKHByb2R1Y3RzKSA9PiB7XG4gIHJldHVybiBwcm9kdWN0cy5maWx0ZXIocHJvZHVjdCA9PiAhcHJvZHVjdC5zcG9uc29yZWQpO1xufTtcblxuY29uc3QgaW5zZXJ0UHJvZHVjdCA9IGFzeW5jIChwcm9kdWN0KSA9PiB7XG4gIGlmICghcG9vbCkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIHBvb2wgbm90IGluaXRpYWxpemVkJyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgcG9vbC5jb25uZWN0KCk7XG4gIHRyeSB7XG4gICAgYXdhaXQgY2xpZW50LnF1ZXJ5KCdCRUdJTicpO1xuXG4gICAgLy8gSW5zZXJ0IGludG8gcHJvZHVjdHMgdGFibGVcbiAgICBjb25zdCBwcm9kdWN0UXVlcnkgPSBgXG4gICAgICBJTlNFUlQgSU5UTyBwcm9kdWN0cyAocmV0YWlsZXJfaWQsIHNvdXJjZSwgdGl0bGUsIGJyYW5kLCBpbWFnZV91cmwsIGxpbmssIGZ1bGxfZGVzY3JpcHRpb24sIHByb2R1Y3RfY2F0ZWdvcnkpXG4gICAgICBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0LCAkNSwgJDYsICQ3LCAkOClcbiAgICAgIE9OIENPTkZMSUNUIChyZXRhaWxlcl9pZCwgc291cmNlKSBETyBVUERBVEVcbiAgICAgIFNFVCB0aXRsZSA9IEVYQ0xVREVELnRpdGxlLCBicmFuZCA9IEVYQ0xVREVELmJyYW5kLCBpbWFnZV91cmwgPSBFWENMVURFRC5pbWFnZV91cmwsIFxuICAgICAgICAgIGxpbmsgPSBFWENMVURFRC5saW5rLCBmdWxsX2Rlc2NyaXB0aW9uID0gRVhDTFVERUQuZnVsbF9kZXNjcmlwdGlvbiwgXG4gICAgICAgICAgcHJvZHVjdF9jYXRlZ29yeSA9IEVYQ0xVREVELnByb2R1Y3RfY2F0ZWdvcnlcbiAgICAgIFJFVFVSTklORyBwcm9kdWN0X2lkXG4gICAgYDtcbiAgICBjb25zdCBwcm9kdWN0VmFsdWVzID0gW1xuICAgICAgcHJvZHVjdC5pZCB8fCBwcm9kdWN0LmFzaW4sXG4gICAgICBwcm9kdWN0LnNvdXJjZSxcbiAgICAgIHByb2R1Y3QudGl0bGUsXG4gICAgICBwcm9kdWN0LmJyYW5kLFxuICAgICAgcHJvZHVjdC5pbWFnZSxcbiAgICAgIHByb2R1Y3QubGluayxcbiAgICAgIHByb2R1Y3QuZnVsbF9kZXNjcmlwdGlvbixcbiAgICAgIHByb2R1Y3QucHJvZHVjdF9jYXRlZ29yeVxuICAgIF07XG4gICAgY29uc3QgcHJvZHVjdFJlc3VsdCA9IGF3YWl0IGNsaWVudC5xdWVyeShwcm9kdWN0UXVlcnksIHByb2R1Y3RWYWx1ZXMpO1xuICAgIGNvbnN0IHByb2R1Y3RJZCA9IHByb2R1Y3RSZXN1bHQucm93c1swXS5wcm9kdWN0X2lkO1xuXG4gICAgLy8gSW5zZXJ0IGludG8gcHJvZHVjdF9kZXRhaWxzIHRhYmxlXG4gICAgY29uc3QgZGV0YWlsc1F1ZXJ5ID0gYFxuICAgICAgSU5TRVJUIElOVE8gcHJvZHVjdF9kZXRhaWxzIChwcm9kdWN0X2lkLCByYXRpbmcsIHJhdGluZ3NfdG90YWwsIGlzX3ByaW1lLCBtb2RlbCwgc21hbGxfZGVzY3JpcHRpb24pXG4gICAgICBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0LCAkNSwgJDYpXG4gICAgICBPTiBDT05GTElDVCAocHJvZHVjdF9pZCkgRE8gVVBEQVRFXG4gICAgICBTRVQgcmF0aW5nID0gRVhDTFVERUQucmF0aW5nLCByYXRpbmdzX3RvdGFsID0gRVhDTFVERUQucmF0aW5nc190b3RhbCwgXG4gICAgICAgICAgaXNfcHJpbWUgPSBFWENMVURFRC5pc19wcmltZSwgbW9kZWwgPSBFWENMVURFRC5tb2RlbCwgXG4gICAgICAgICAgc21hbGxfZGVzY3JpcHRpb24gPSBFWENMVURFRC5zbWFsbF9kZXNjcmlwdGlvblxuICAgIGA7XG4gICAgY29uc3QgZGV0YWlsc1ZhbHVlcyA9IFtcbiAgICAgIHByb2R1Y3RJZCxcbiAgICAgIHBhcnNlRmxvYXQocHJvZHVjdC5yYXRpbmcpIHx8IG51bGwsXG4gICAgICBwYXJzZUludChwcm9kdWN0LnJhdGluZ3NUb3RhbCkgfHwgbnVsbCxcbiAgICAgIHByb2R1Y3QuaXNQcmltZSB8fCBmYWxzZSxcbiAgICAgIHByb2R1Y3QubW9kZWwsXG4gICAgICBwcm9kdWN0LnNtYWxsX2Rlc2NyaXB0aW9uXG4gICAgXTtcbiAgICBhd2FpdCBjbGllbnQucXVlcnkoZGV0YWlsc1F1ZXJ5LCBkZXRhaWxzVmFsdWVzKTtcblxuICAgIC8vIEluc2VydCBpbnRvIHByaWNlX2hpc3RvcnkgdGFibGVcbiAgICBpZiAocHJvZHVjdC5wcmljZSAmJiBwcm9kdWN0LnByaWNlICE9PSBcIk4vQVwiKSB7XG4gICAgICBjb25zdCBwcmljZVF1ZXJ5ID0gYFxuICAgICAgICBJTlNFUlQgSU5UTyBwcmljZV9oaXN0b3J5IChwcm9kdWN0X2lkLCBwcmljZSwgYXZhaWxhYmlsaXR5KVxuICAgICAgICBWQUxVRVMgKCQxLCAkMiwgJDMpXG4gICAgICBgO1xuICAgICAgY29uc3QgcHJpY2VWYWx1ZXMgPSBbXG4gICAgICAgIHByb2R1Y3RJZCxcbiAgICAgICAgcGFyc2VGbG9hdChwcm9kdWN0LnByaWNlLnJlcGxhY2UoL1teMC05Li1dKy9nLFwiXCIpKSB8fCBudWxsLFxuICAgICAgICBwcm9kdWN0LmF2YWlsYWJpbGl0eSB8fCAnVW5rbm93bidcbiAgICAgIF07XG4gICAgICBhd2FpdCBjbGllbnQucXVlcnkocHJpY2VRdWVyeSwgcHJpY2VWYWx1ZXMpO1xuICAgIH1cblxuICAgIGF3YWl0IGNsaWVudC5xdWVyeSgnQ09NTUlUJyk7XG4gICAgY29uc29sZS5sb2coYEluc2VydGVkL1VwZGF0ZWQgcHJvZHVjdCBpbiBkYXRhYmFzZTogJHtwcm9kdWN0LnRpdGxlfWApO1xuICB9IGNhdGNoIChlKSB7XG4gICAgYXdhaXQgY2xpZW50LnF1ZXJ5KCdST0xMQkFDSycpO1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluc2VydGluZy91cGRhdGluZyBwcm9kdWN0IGluIGRhdGFiYXNlOicsIGUpO1xuICB9IGZpbmFsbHkge1xuICAgIGNsaWVudC5yZWxlYXNlKCk7XG4gIH1cbn07XG5cbmNvbnN0IGZldGNoUHJvZHVjdHMgPSBhc3luYyAodGVybSwgc291cmNlLCBzb3J0QnksIHBhZ2UgPSAxKSA9PiB7XG4gIGxldCB1cmw7XG4gIGxldCBwYXJhbXM7XG5cbiAgLy8gUmVtb3ZlIGFueSBxdW90ZXMgZnJvbSB0aGUgQVBJIGtleVxuICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5TQ1JBUEVSX0FQSV9LRVkucmVwbGFjZSgvWycnXCJdKy9nLCAnJyk7XG5cbiAgaWYgKHNvdXJjZSA9PT0gJ2FtYXpvbicpIHtcbiAgICBpZiAodGVybS5tYXRjaCgvXltBLVowLTldezEwfSQvKSkgeyAgLy8gQ2hlY2sgaWYgdGVybSBpcyBhbiBBU0lOXG4gICAgICB1cmwgPSBgaHR0cHM6Ly9hcGkuc2NyYXBlcmFwaS5jb20vc3RydWN0dXJlZC9hbWF6b24vcHJvZHVjdGA7XG4gICAgICBwYXJhbXMgPSB7XG4gICAgICAgIGFwaV9rZXk6IGFwaUtleSxcbiAgICAgICAgYXNpbjogdGVybSxcbiAgICAgICAgY291bnRyeV9jb2RlOiAndXMnLFxuICAgICAgICB0bGQ6ICdjb20nXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICB1cmwgPSBgaHR0cHM6Ly9hcGkuc2NyYXBlcmFwaS5jb20vc3RydWN0dXJlZC9hbWF6b24vc2VhcmNoYDtcbiAgICAgIHBhcmFtcyA9IHtcbiAgICAgICAgYXBpX2tleTogYXBpS2V5LFxuICAgICAgICBxdWVyeTogdGVybSxcbiAgICAgICAgY291bnRyeTogJ3VzJyxcbiAgICAgICAgcGFnZTogcGFnZS50b1N0cmluZygpLFxuICAgICAgICBzb3J0X2J5OiBzb3J0QnkgfHwgJycsXG4gICAgICAgIGV4Y2x1ZGVfc3BvbnNvcmVkOiAndHJ1ZSdcbiAgICAgIH07XG4gICAgfVxuICB9IGVsc2UgaWYgKHNvdXJjZSA9PT0gJ3dhbG1hcnQnKSB7XG4gICAgaWYgKHRlcm0ubWF0Y2goL15bMC05XSskLykpIHsgIC8vIENoZWNrIGlmIHRlcm0gaXMgYSBXYWxtYXJ0IHByb2R1Y3QgSURcbiAgICAgIHVybCA9IGBodHRwczovL2FwaS5zY3JhcGVyYXBpLmNvbS9zdHJ1Y3R1cmVkL3dhbG1hcnQvcHJvZHVjdGA7XG4gICAgICBwYXJhbXMgPSB7XG4gICAgICAgIGFwaV9rZXk6IGFwaUtleSxcbiAgICAgICAgcHJvZHVjdF9pZDogdGVybSxcbiAgICAgICAgY291bnRyeV9jb2RlOiAndXMnLFxuICAgICAgICB0bGQ6ICdjb20nXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICB1cmwgPSBgaHR0cHM6Ly9hcGkuc2NyYXBlcmFwaS5jb20vc3RydWN0dXJlZC93YWxtYXJ0L3NlYXJjaGA7XG4gICAgICBwYXJhbXMgPSB7XG4gICAgICAgIGFwaV9rZXk6IGFwaUtleSxcbiAgICAgICAgcXVlcnk6IHRlcm0sXG4gICAgICAgIGNvdW50cnk6ICd1cycsXG4gICAgICAgIHBhZ2U6IHBhZ2UudG9TdHJpbmcoKSxcbiAgICAgICAgc29ydF9ieTogc29ydEJ5IHx8ICcnLFxuICAgICAgICBleGNsdWRlX3Nwb25zb3JlZDogJ3RydWUnXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coYEZldGNoaW5nICR7c291cmNlfSByZXN1bHRzIGZvciB0ZXJtOiBcIiR7dGVybX1cIiwgcGFnZTogJHtwYWdlfSwgc29ydEJ5OiAke3NvcnRCeX1gKTtcbiAgICBjb25zb2xlLmxvZygnQVBJIFJlcXVlc3QgVVJMOicsIHVybCk7XG4gICAgY29uc29sZS5sb2coJ0FQSSBSZXF1ZXN0IFBhcmFtczonLCB7IC4uLnBhcmFtcywgYXBpX2tleTogJ1tSRURBQ1RFRF0nIH0pO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQodXJsLCB7IHBhcmFtcywgdGltZW91dDogMzAwMDAgfSk7XG4gICAgY29uc29sZS5sb2coYFJhdyBBUEkgcmVzcG9uc2UgZnJvbSAke3NvdXJjZX06YCwgSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YSwgbnVsbCwgMikpO1xuXG4gICAgbGV0IGpzb25EYXRhID0gcmVzcG9uc2UuZGF0YTtcblxuICAgIGlmICgoc291cmNlID09PSAnYW1hem9uJyAmJiB0ZXJtLm1hdGNoKC9eW0EtWjAtOV17MTB9JC8pKSB8fCBcbiAgICAgICAgKHNvdXJjZSA9PT0gJ3dhbG1hcnQnICYmIHRlcm0ubWF0Y2goL15bMC05XSskLykpKSB7XG4gICAgICAvLyBJZiBpdCdzIGEgcHJvZHVjdCBxdWVyeSwgd3JhcCB0aGUgcmVzdWx0IGluIGFuIGFycmF5XG4gICAgICBjb25zdCBtYXBwZWRQcm9kdWN0ID0gbWFwUHJvZHVjdChqc29uRGF0YSwgc291cmNlKTtcbiAgICAgIGF3YWl0IGluc2VydFByb2R1Y3QobWFwcGVkUHJvZHVjdCk7XG4gICAgICByZXR1cm4geyByZXN1bHRzOiBbbWFwcGVkUHJvZHVjdF0sIHRvdGFsUGFnZXM6IDEgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRm9yIHNlYXJjaCBxdWVyaWVzLCBwcm9jZXNzIGFzIGJlZm9yZVxuICAgICAgbGV0IHJlc3VsdHMgPSBbXTtcbiAgICAgIGxldCB0b3RhbFBhZ2VzID0gMTtcblxuICAgICAgaWYgKHNvdXJjZSA9PT0gJ3dhbG1hcnQnICYmIGpzb25EYXRhLml0ZW1zICYmIEFycmF5LmlzQXJyYXkoanNvbkRhdGEuaXRlbXMpKSB7XG4gICAgICAgIHJlc3VsdHMgPSBqc29uRGF0YS5pdGVtcztcbiAgICAgICAgdG90YWxQYWdlcyA9IGpzb25EYXRhLnRvdGFsX3BhZ2VzIHx8IDE7XG4gICAgICB9IGVsc2UgaWYgKHNvdXJjZSA9PT0gJ2FtYXpvbicgJiYganNvbkRhdGEucmVzdWx0cykge1xuICAgICAgICByZXN1bHRzID0ganNvbkRhdGEucmVzdWx0cztcbiAgICAgICAgdG90YWxQYWdlcyA9IGpzb25EYXRhLnRvdGFsX3BhZ2VzIHx8IDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBJbnZhbGlkIEFQSSByZXNwb25zZSBzdHJ1Y3R1cmUgZnJvbSAke3NvdXJjZX06YCwganNvbkRhdGEpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgQVBJIHJlc3BvbnNlIHN0cnVjdHVyZSBmcm9tICR7c291cmNlfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBtYXBwZWRSZXN1bHRzID0gcmVzdWx0cy5tYXAoaXRlbSA9PiBtYXBQcm9kdWN0KGl0ZW0sIHNvdXJjZSkpO1xuICAgICAgY29uc29sZS5sb2coYE1hcHBlZCByZXN1bHRzIGZvciAke3NvdXJjZX06YCwgSlNPTi5zdHJpbmdpZnkobWFwcGVkUmVzdWx0cywgbnVsbCwgMikpO1xuXG4gICAgICAvLyBJbnNlcnQgYWxsIHByb2R1Y3RzIGludG8gdGhlIGRhdGFiYXNlXG4gICAgICBmb3IgKGNvbnN0IHByb2R1Y3Qgb2YgbWFwcGVkUmVzdWx0cykge1xuICAgICAgICBhd2FpdCBpbnNlcnRQcm9kdWN0KHByb2R1Y3QpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4geyByZXN1bHRzOiBmaWx0ZXJTcG9uc29yZWRQcm9kdWN0cyhtYXBwZWRSZXN1bHRzKSwgdG90YWxQYWdlcyB9O1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciBmZXRjaGluZyBkYXRhIGZyb20gJHtzb3VyY2V9IEFQSTpgLCBlcnJvci5tZXNzYWdlKTtcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciBkZXRhaWxzOmAsIGVycm9yLnJlc3BvbnNlID8gZXJyb3IucmVzcG9uc2UuZGF0YSA6ICdObyByZXNwb25zZSBkYXRhJyk7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdHRVQnKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5lbmQoKTtcbiAgfVxuXG4gIGNvbnN0IHsgdGVybSwgcGFnZSA9ICcxJywgc29ydF9ieSwgc291cmNlID0gJ2FsbCcgfSA9IHJlcS5xdWVyeTtcblxuICByZXMuc2V0SGVhZGVyKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbicpO1xuXG4gIGNvbnN0IHJlc3VsdHMgPSBbXTtcblxuICBjb25zdCBzdHJlYW1SZXN1bHRzID0gYXN5bmMgKHNvdXJjZVRvRmV0Y2gpID0+IHtcbiAgICBjb25zdCBjYWNoZUtleSA9IGBzZWFyY2g6JHtzb3VyY2VUb0ZldGNofToke3Rlcm19OiR7c29ydF9ieX06JHtwYWdlfWA7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNhY2hlZFJlc3VsdHMgPSBhd2FpdCBjYWNoZUhlbHBlci5nZXQoY2FjaGVLZXkpO1xuXG4gICAgICBpZiAoY2FjaGVkUmVzdWx0cykge1xuICAgICAgICBjb25zb2xlLmxvZyhgVXNpbmcgY2FjaGVkIHJlc3VsdHMgZm9yICR7c291cmNlVG9GZXRjaH1gKTtcbiAgICAgICAgcmVzdWx0cy5wdXNoKHsgc291cmNlOiBzb3VyY2VUb0ZldGNoLCAuLi5KU09OLnBhcnNlKGNhY2hlZFJlc3VsdHMpIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coYEZldGNoaW5nIGZyZXNoIHJlc3VsdHMgZm9yICR7c291cmNlVG9GZXRjaH1gKTtcbiAgICAgICAgY29uc3QgeyByZXN1bHRzOiBzb3VyY2VSZXN1bHRzLCB0b3RhbFBhZ2VzIH0gPSBhd2FpdCBmZXRjaFByb2R1Y3RzKHRlcm0sIHNvdXJjZVRvRmV0Y2gsIHNvcnRfYnksIHBhcnNlSW50KHBhZ2UpKTtcbiAgICAgICAgcmVzdWx0cy5wdXNoKHsgc291cmNlOiBzb3VyY2VUb0ZldGNoLCByZXN1bHRzOiBzb3VyY2VSZXN1bHRzLCB0b3RhbFBhZ2VzIH0pO1xuICAgICAgICBhd2FpdCBjYWNoZUhlbHBlci5zZXQoY2FjaGVLZXksIEpTT04uc3RyaW5naWZ5KHsgcmVzdWx0czogc291cmNlUmVzdWx0cywgdG90YWxQYWdlcyB9KSwgeyBFWDogMzYwMCB9KTsgLy8gQ2FjaGUgZm9yIDEgaG91clxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBzdHJlYW1pbmcgcmVzdWx0cyBmcm9tICR7c291cmNlVG9GZXRjaH06YCwgZXJyb3IubWVzc2FnZSk7XG4gICAgICByZXN1bHRzLnB1c2goeyBcbiAgICAgICAgc291cmNlOiBzb3VyY2VUb0ZldGNoLCBcbiAgICAgICAgZXJyb3I6IGBGYWlsZWQgdG8gZmV0Y2ggZGF0YSBmcm9tICR7c291cmNlVG9GZXRjaH06ICR7ZXJyb3IubWVzc2FnZX1gLFxuICAgICAgICBkZXRhaWxzOiBlcnJvci5yZXNwb25zZSA/IGVycm9yLnJlc3BvbnNlLmRhdGEgOiAnTm8gcmVzcG9uc2UgZGF0YSdcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBpZiAoc291cmNlID09PSAnYWxsJykge1xuICAgIGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgIHN0cmVhbVJlc3VsdHMoJ3dhbG1hcnQnKSxcbiAgICAgIHN0cmVhbVJlc3VsdHMoJ2FtYXpvbicpXG4gICAgXSk7XG4gIH0gZWxzZSB7XG4gICAgYXdhaXQgc3RyZWFtUmVzdWx0cyhzb3VyY2UpO1xuICB9XG5cbiAgcmVzLnN0YXR1cygyMDApLmpzb24ocmVzdWx0cyk7XG59Il0sIm5hbWVzIjpbImF4aW9zIiwiUmVkaXMiLCJQb29sIiwicmVkaXNDbGllbnQiLCJwcm9jZXNzIiwiZW52IiwiUkVESVNfVVJMIiwibWF4UmV0cmllc1BlclJlcXVlc3QiLCJyZXRyeVN0cmF0ZWd5Iiwib24iLCJlcnIiLCJjb25zb2xlIiwid2FybiIsImVycm9yIiwicG9vbCIsImNvbm5lY3Rpb25TdHJpbmciLCJEQVRBQkFTRV9VUkwiLCJzc2wiLCJyZWplY3RVbmF1dGhvcml6ZWQiLCJxdWVyeSIsInJlcyIsImxvZyIsImNhY2hlSGVscGVyIiwiZ2V0Iiwia2V5Iiwic2V0IiwidmFsdWUiLCJvcHRpb25zIiwibWFwUHJvZHVjdCIsIml0ZW0iLCJzb3VyY2UiLCJKU09OIiwic3RyaW5naWZ5IiwiaWQiLCJicmFuZCIsInRpdGxlIiwibmFtZSIsImxpbmsiLCJ1cmwiLCJpbWFnZSIsImlzUHJpbWUiLCJyYXRpbmciLCJhdmVyYWdlX3JhdGluZyIsIk51bWJlciIsInRvRml4ZWQiLCJyYXRpbmdzVG90YWwiLCJudW1iZXJfb2ZfcmV2aWV3cyIsInByaWNlIiwicHJpY2VfY3VycmVuY3kiLCJhdmFpbGFiaWxpdHkiLCJzcG9uc29yZWQiLCJmdWxsX2Rlc2NyaXB0aW9uIiwicHJvZHVjdF9jYXRlZ29yeSIsIm1vZGVsIiwic21hbGxfZGVzY3JpcHRpb24iLCJhc2luIiwiaW1hZ2VzIiwiaGFzX3ByaW1lIiwic3RhcnMiLCJ0b3RhbF9yZXZpZXdzIiwicmF0aW5nc190b3RhbCIsInByaWNpbmciLCJmaWx0ZXJTcG9uc29yZWRQcm9kdWN0cyIsInByb2R1Y3RzIiwiZmlsdGVyIiwicHJvZHVjdCIsImluc2VydFByb2R1Y3QiLCJjbGllbnQiLCJjb25uZWN0IiwicHJvZHVjdFF1ZXJ5IiwicHJvZHVjdFZhbHVlcyIsInByb2R1Y3RSZXN1bHQiLCJwcm9kdWN0SWQiLCJyb3dzIiwicHJvZHVjdF9pZCIsImRldGFpbHNRdWVyeSIsImRldGFpbHNWYWx1ZXMiLCJwYXJzZUZsb2F0IiwicGFyc2VJbnQiLCJwcmljZVF1ZXJ5IiwicHJpY2VWYWx1ZXMiLCJyZXBsYWNlIiwiZSIsInJlbGVhc2UiLCJmZXRjaFByb2R1Y3RzIiwidGVybSIsInNvcnRCeSIsInBhZ2UiLCJwYXJhbXMiLCJhcGlLZXkiLCJTQ1JBUEVSX0FQSV9LRVkiLCJtYXRjaCIsImFwaV9rZXkiLCJjb3VudHJ5X2NvZGUiLCJ0bGQiLCJjb3VudHJ5IiwidG9TdHJpbmciLCJzb3J0X2J5IiwiZXhjbHVkZV9zcG9uc29yZWQiLCJyZXNwb25zZSIsInRpbWVvdXQiLCJkYXRhIiwianNvbkRhdGEiLCJtYXBwZWRQcm9kdWN0IiwicmVzdWx0cyIsInRvdGFsUGFnZXMiLCJpdGVtcyIsIkFycmF5IiwiaXNBcnJheSIsInRvdGFsX3BhZ2VzIiwiRXJyb3IiLCJtYXBwZWRSZXN1bHRzIiwibWFwIiwibWVzc2FnZSIsImhhbmRsZXIiLCJyZXEiLCJtZXRob2QiLCJzdGF0dXMiLCJlbmQiLCJzZXRIZWFkZXIiLCJzdHJlYW1SZXN1bHRzIiwic291cmNlVG9GZXRjaCIsImNhY2hlS2V5IiwiY2FjaGVkUmVzdWx0cyIsInB1c2giLCJwYXJzZSIsInNvdXJjZVJlc3VsdHMiLCJFWCIsImRldGFpbHMiLCJQcm9taXNlIiwiYWxsIiwianNvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/search.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsearch&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fsearch.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();